<h4 class="mt-4 mb-4">Informações Gerais</h4>

{% if not is_ac and aula.alunos.all %}
<h6 class="text-muted">Lista de Presença (Alunos)</h6>
<ul class="list-group list-group-flush mb-4">
    {% for presenca in aula.presencas.all %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
        <span>{{ presenca.aluno.nome_completo|title }}</span>
        
        <div>
            {% if presenca.status == 'presente' %}
                <span class="badge bg-success-subtle text-success-emphasis rounded-pill">Presente</span>
            
            {% elif presenca.status == 'ausente' %}
                {# Primeiro, o badge de Ausente #}
                <span class="badge bg-warning-subtle text-warning-emphasis rounded-pill me-1">Ausente</span>
                
                {# Depois, o badge do TIPO de falta #}
                {% if presenca.tipo_falta == 'justificada' %}
                    <span class="badge bg-info-subtle text-info-emphasis rounded-pill">Justificada</span>
                {% else %}
                    <span class="badge bg-danger-subtle text-danger-emphasis rounded-pill">Injustificada</span>
                {% endif %}
            {% endif %}
        </div>
        </li>
    {% endfor %}
</ul>
{% elif is_ac %}
    {# O bloco para professores permanece o mesmo #}
    <h6 class="text-muted">Lista de Presença (Professores)</h6>
    <ul class="list-group list-group-flush mb-4">
        {% for presenca in aula.presencas_professores.all %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
            {{ presenca.professor.username|title }}
            {% if presenca.status == 'presente' %}<span class="badge bg-success-subtle text-success-emphasis rounded-pill">Presente</span>{% else %}<span class="badge bg-secondary-subtle text-secondary-emphasis rounded-pill">Ausente</span>{% endif %}
        </li>
        {% endfor %}
    </ul>
{% endif %}

{# A seção de validação permanece a mesma #}
<h6 class="text-muted">Validação do Relatório</h6>
<div class="small">
    <p class="mb-1">
        <strong>Professor que realizou a aula:</strong> 
        <span class="badge bg-primary-subtle text-primary-emphasis">
            {{ relatorio.professor_que_validou.username|title|default:"Não registrado" }}
        </span>
    </p>

    {% if aula.foi_substituida %}
    <p class="mb-1">
        <strong>Professor originalmente atribuído:</strong>
        {% for prof in aula.professores.all %}
            <span class="badge bg-secondary-subtle text-secondary-emphasis">
                {{ prof.username|title }}
            </span>{% if not forloop.last %}, {% endif %}
        {% empty %}
            <span class="text-muted">N/A</span>
        {% endfor %}
    </p>
    {% endif %}
    <p class="mb-0"><strong>Última atualização:</strong> {{ relatorio.data_atualizacao|date:"d/m/Y H:i" }}</p>
</div>